/* CREATE TABLES */


CREATE TABLE genere(
	nome VARCHAR(40) NOT NULL PRIMARY KEY
);

CREATE TABLE brano(
	titolo VARCHAR(40) NOT NULL,
	album VARCHAR(40) NOT NULL,
	num INT NOT NULL,
	artista VARCHAR(40) NOT NULL,
	genere VARCHAR(40) NOT NULL,
	FOREIGN KEY(genere) REFERENCES genere(nome),
	PRIMARY KEY(titolo, album, num, artista)
);

CREATE TABLE utente(
	id SERIAL PRIMARY KEY NOT NULL,
	username VARCHAR(20) NOT NULL,
	password VARCHAR(32) NOT NULL,
	nome VARCHAR(20) NOT NULL,
	cognome VARCHAR(20) NOT NULL,
	eta INT NOT NULL,
	email VARCHAR(30) NOT NULL,
	generepref VARCHAR(40),
	FOREIGN KEY(generepref) REFERENCES genere(nome),
	UNIQUE(email, username)
);


/* INSERT DATA */


INSERT INTO genere VALUES('rock');
INSERT INTO genere VALUES('jazz');
INSERT INTO genere VALUES('pop');
INSERT INTO genere VALUES('elettronica');
INSERT INTO genere VALUES('cantautorato');
INSERT INTO genere VALUES('blues');

INSERT INTO utente (username, password, nome, cognome, eta, email) VALUES('claudiu', 'Abcd1234', 'Claudiu', 'Ivan', 21, 'claudiu97@htomail.com');
INSERT INTO utente (username, password, nome, cognome, eta, email) VALUES('edoardo', 'Abcd1234', 'Edoardo', 'Liberati', 21, 'edoardo.liberati27@gmail.com');

INSERT INTO brano (titolo, album, num, artista, genere) VALUES('quixoticelixer', 'californication', 18, 'red_hot_chili_peppers', 'rock');
INSERT INTO brano (titolo, album, num, artista, genere) VALUES('comeback_kid', 'for_crying_out_loud', 6, 'kasabian', 'rock');
INSERT INTO brano (titolo, album, num, artista, genere) VALUES('tesselate', 'an_awesome_wave', 3, 'alt-j', 'rock');
INSERT INTO brano (titolo, album, num, artista, genere) VALUES('sugar_sugar', 'californication', 19, 'red_hot_chili_peppers', 'rock');
INSERT INTO brano (titolo, album, num, artista, genere) VALUES('III_ray_(the_king)', 'for_crying_out_loud', 6, 'kasabian', 'rock');


/* UPDATE GENERES */


UPDATE utente SET generepref='rock' WHERE username='claudiu';
UPDATE utente SET generepref='elettronica' WHERE username='edoardo';